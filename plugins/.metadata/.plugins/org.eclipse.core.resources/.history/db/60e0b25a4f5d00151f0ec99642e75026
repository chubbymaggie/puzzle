package es.us.isa.fama;

import java.io.File;
import java.net.URL;

import org.eclipse.core.runtime.FileLocator;
import org.eclipse.core.runtime.Platform;

import es.us.isa.FAMA.Reasoner.ConfigurableQuestionFactory;
import es.us.isa.FAMA.Reasoner.Question;
import es.us.isa.FAMA.Reasoner.QuestionTrader;
import es.us.isa.FAMA.Reasoner.Reasoner;

public class PluginQuestionTrader extends QuestionTrader {

	@SuppressWarnings("unchecked")
	public PluginQuestionTrader(){
		super("OSGI");
		
		try {
			this.questionsMap.put("Products", (Class<Question>) Class.forName("es.us.isa.FAMA.Reasoner.questions.ProductsQuestion"));
			this.questionsMap.put("#Products", (Class<Question>) Class.forName("es.us.isa.FAMA.Reasoner.questions.NumberOfProductsQuestion"));

			URL libFolderPath = Platform.getBundle("es.us.isa.fama").getEntry("/libs");
			File libFolder = new File(FileLocator.resolve(libFolderPath).toURI());
	        File projectFolder = new File(project.getLocation().toString());
			
			Reasoner reasoner = es.us.isa.ChocoReasoner.ChocoReasoner.class.newInstance();
			ConfigurableQuestionFactory qFact = new ConfigurableQuestionFactory();
			qFact.setClassLoader(reasoner.getClass().getClassLoader());
			qFact.parseConfigFile(configStream);
			reasoner.setFactory(qFact);
			
			this.reasonersIdMap.put("Choco", es.us.isa.ChocoReasoner.ChocoReasoner.class.newInstance());
			this.reasonersIdMap.put("Choco4exp", es.us.isa.ChocoReasoner4Exp.ChocoReasoner.class.newInstance());
			this.reasonersIdMap.put("ChocoAttributed", es.us.isa.ChocoReasoner.attributed.ChocoReasoner.class.newInstance());
			this.reasonersIdMap.put("ChocoAttributed4exp", es.us.isa.ChocoReasoner4Exp.attributed.ChocoReasoner.class.newInstance());
			this.reasonersIdMap.put("Sat4j", es.us.isa.Sat4jReasoner.Sat4jReasoner.class.newInstance());
		} catch (Exception e) {
			e.printStackTrace();
		}
		
		
	}
}
