package es.us.isa.fama;

import java.io.File;
import java.io.IOException;
import java.net.URISyntaxException;
import java.net.URL;
import java.util.LinkedList;

import org.eclipse.core.runtime.FileLocator;
import org.eclipse.core.runtime.Platform;

import es.us.isa.FAMA.Reasoner.DefaultCriteriaSelector;
import es.us.isa.FAMA.Reasoner.QuestionTrader;
import es.us.isa.FAMA.loader.ExtensionsLoaderFactory;
import es.us.isa.FAMA.stagedConfigManager.Configuration;

public class PluginQuestionTrader extends QuestionTrader {

	public PluginQuestionTrader(){
		super();
		
		URL libFolderPath = Platform.getBundle("es.us.isa.fama").getEntry("/FaMaConfig.xml");
		try {
			File libFolder = new File(FileLocator.resolve(libFolderPath).toURI());
			extFactory = new ExtensionsLoaderFactory();
			extLoad = extFactory.createExtensionsLoader(libFolder.getAbsolutePath(), this);
			reasoners = extLoad.getReasoners();
			selectorsMap = extLoad.getSelectorsMap();
			questionsMap = extLoad.getQuestionsMap();
			reasonersIdMap = extLoad.getReasonersIdMap();
			transformationsMap = extLoad.getTransformationsMap();
			configurations = new LinkedList<Configuration>();
			selector = new DefaultCriteriaSelector(this);
			mp = extLoad.getModelParser();
		} catch (URISyntaxException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		
		
	}
}
